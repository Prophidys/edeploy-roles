---
# file: roles/full/tasks/main.yml
# this role is used when all services are running on the same node.

- name: edeploy upgrade
  edeploy: command=upgrade version=D7-{{ version }}
  tags: before_config
  when: ansible_distribution == 'Debian'

# In this release, we upgrade HAproxy from 1.4 to 1.5 to support SSL termination.
- name: restart HAproxy
  service: name=haproxy state=restarted
  tags: before_config
  when: ansible_distribution == 'Debian'

# In this release, heat-engine is no more SPOF
- name: remove heat-engine from pacemaker
command: crm configure delete heat-engine
  tags: after_config
  when: inventory_hostname == groups['full'][-1]
